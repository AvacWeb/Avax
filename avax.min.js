/**
 * Avax
 * A small Javascript Ajax handler with form management.
 *
 * Copyright 2011-2012 AvacWeb (avacweb.com)
 * Released under the MIT and GPL Licenses.
 */
$avax=function(){var e={responseCache:{},localURL:window.location.hostname,config:{type:"GET",async:!0,headers:{},params:{avax:1},oncomplete:function(){},onstatechange:function(){},onfailure:function(){},response:"responseText",cache:!1}};e.XHR=window.XMLHttpRequest?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")};e.XHR2=function(){var a=new XMLHttpRequest;return"withCredentials"in a?a:"undefined"!=typeof XDomainRequest?new XDomainRequest:null};e.params=function(a){if(a.join)return a.join("&");if("string"===typeof a)return a.replace(/^\?/,"");if("object"===typeof a){var c=[],d;for(d in a)c.push(d+"="+encodeURIComponent(a[d]));return c.join("&")}};e.cache=function(a,c,d){a=a+" "+c;d&&(this.responseCache[a]=d);return this.responseCache[a]};e.localTest=function(a){return null!=RegExp("(^|\\W)"+this.localURL+"(\\W|$)").exec(a)};e.mergeObj=function(a,c){for(var d in c)d in a||(a[d]=c[d]);return a};e.ajax=function(a){if(a.url){var c=this.config,d=this.mergeObj(a.headers||{},c.headers),c=this.params(c.params),a=this.mergeObj(a,this.config),c=this.params(a.params||"")+(c.length?"&"+c:""),f=a.cache?this.cache(a.url,c):null;if(f)return a.oncomplete.call(b,f);var b=this.localTest(a.url)?this.XHR():this.XHR2();if(!b)return null;b.open(a.type,a.url,a.async);for(var j in d)b.setRequestHeader(j,d[j]);var g=function(){a.cache&&e.cache(a.url,data,b[a.response]);a.oncomplete.call(b,b[a.response])};a.async&&(b.onload?(b.onload=g,b.onerror=function(){a.onfailure.call(b,b.status)}):b.onreadystatechange=function(){if(4==b.readyState)200===b.status?g():a.onfailure.call(b,b.status);else a.onstatechange(b)});b.send(c);a.async||g();return b}};e.get=function(a,c){var d={url:a};c&&(d.oncomplete=c);return this.ajax(d)};e.post=function(a,c,d){a={type:"POST",url:a,params:c,headers:this.mergeObj(this.config.headers,{"Content-type":"application/x-www-form-urlencoded"})};d&&(a.oncomplete=d);return this.ajax(a)};e.serialize=function(a){for(var c={input:1,select:1,textarea:1},a=a.all?a.all:a.getElementsByTagName("*"),d=0,f=[],b=a[0];b;b=a[++d]){var e=b.tagName.toLowerCase(),g=b.name||b.getAttribute("name"),h=b.getAttribute("type"),i=b.value?encodeURIComponent(b.value):null;!(!e in c)&&g&&("input"==e?"button"==h||("submit"==h||"reset"==h)||("checkbox"==h||"radio"==h?b.checked&&f.push(g+"="+i):f.push(g+"="+i)):"textarea"==e?f.push(g+"="+i):"select"==e&&(i?f.push(g+"="+i):f.push(g+"="+b.options[b.selectedIndex].value)))}return f.join("&")};e.sendForm=function(a,c,d){if("form"===a.tagName.toLowerCase()){var f=a.action||window.location.pathname,b=a.method?a.method.toLowerCase():"get",a=this.serialize(a)+(d?"&"+this.params(d):"");"get"==b&&(f+=(f.indexOf("?")?"&":"?")+a);if("get"==b||"post"==b)return e[b](f,"get"==b?c:a,c);f={url:f,type:b,params:a};c&&(f.oncomplete=c);return e.ajax(f)}};return e}();